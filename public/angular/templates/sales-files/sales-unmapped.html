<div class="jumbotron" data-pages="parallax">
  <div class="container-fluid container-fixed-lg sm-p-l-20 sm-p-r-20">
    <div class="inner">
      <ul class="breadcrumb">
        <li>
          <p>Curve</p>
        </li>
        <li><a href="/#/sales">Sales</a></li>
        <li><a href="/#/sales/unmapped" class="active">Unmapped</a></li>
        </li>
      </ul>
    </div>
  </div>
</div>
<!-- Main Container -->
<div class="container-fluid container-fixed-lg">
  <div class="row m-t-40">
    <div class="col-xs-6 col-md-4">
      <div class="form-group required">
        <label>Track Title</label>
        <input type="text" class="form-control" ng-model="filter.trackTitle">
      </div>
    </div>
    <div class="col-xs-6 col-md-4">
      <div class="form-group required">
        <label>Barcode</label>
        <input type="text" class="form-control" ng-model="filter.barcode">
      </div>
    </div>
    <div class="col-xs-6 col-md-4">
      <div class="form-group required">
        <label>Distrubution Channel</label>
        <input type="text" class="form-control" ng-model="filter.distributionChannel">
      </div>
    </div>
    <div class="col-xs-6 col-md-4">
      <div class="form-group required">
        <label>Track Artist</label>
        <input type="text" class="form-control" ng-model="filter.trackArtist">
      </div>
    </div>
    <div class="col-xs-6 col-md-4">
      <div class="form-group required">
        <label>Cat No.</label>
        <input type="text" class="form-control" ng-model="filter.catNo">
      </div>
    </div>
    <div class="col-xs-6 col-md-4">
      <div class="form-group required">
        <label>Configuration</label>
        <input type="text" class="form-control" ng-model="filter.configuration">
      </div>
    </div>
    <div class="col-xs-6 col-md-4">
      <div class="form-group required">
        <label>Album Title</label>
        <input type="text" class="form-control" ng-model="filter.albumTitle">
      </div>
    </div>
    <div class="col-xs-6 col-md-4">
      <div class="form-group required">
        <label>ISRC</label>
        <input type="text" class="form-control" ng-model="filter.isrc">
      </div>
    </div>
    <div class="col-xs-6 col-md-4">
      <div class="form-group required">
        <label>Source</label>
        <input type="text" class="form-control" ng-model="filter.source">
      </div>
    </div>
    <div class="col-xs-6 col-md-4">
      <div class="form-group required">
        <label>Album Artist</label>
        <input type="text" class="form-control" ng-model="filter.albumArtist">
      </div>
    </div>
    <div class="col-xs-6 col-md-4">
      <div class="form-group required">
        <label>Territory</label>
        <input type="text" class="form-control" ng-model="filter.territory">
      </div>
    </div>
    <div class="col-xs-6 col-md-4">
      <div class="form-group required">
        <label>Subsource</label>
        <input type="text" class="form-control" ng-model="filter.subsource">
      </div>
    </div>
    <div class="col-xs-6 col-md-4">
      <div class="form-group required">
        <label>Status</label>
        <ui-select ng-model="filter.status">
          <ui-select-match allow-clear="true">
            <span ng-bind="$select.selected"></span>
          </ui-select-match>
          <ui-select-choices repeat="item in status">
            <span ng-bind="item"></span>
          </ui-select-choices>
        </ui-select>
      </div>
    </div>
    <div class="col-xs-6 col-md-4">
      <div class="form-group required">
        <label>Sales File</label>
        <ui-select ng-model="filter.salesFileId">
          <ui-select-match allow-clear="true">
            <span ng-bind="$select.selected.name"></span>
          </ui-select-match allow-clear="true">
          <ui-select-choices repeat="item._id as item in salesFiles | filter:$select.search">
            <span ng-bind="item.name"></span>
          </ui-select-choices>
        </ui-select>
      </div>
    </div>

  </div>
  <!-- Buttons and Total -->
  <div class="row">
    <div class="col-xs-12 center">
      <button class="btn btn-complete" ng-click="search()"><i class="fa fa-search"></i>&nbsp;Filter</button>
    </div>
  </div>
  <div class="row">
    <div class="col-xs-6">
      <button class="btn btn-primary" data-toggle="modal" data-target="#modalEditFields" ng-click="editSelected()">&nbsp;Edit Selected</button>
      <button class="btn btn-success" data-toggle="modal" data-target="#modalEditFields" ng-click="editFiltered()">&nbsp;Edit Filtered</button>
    </div>
    <div class="col-xs-6">
      <h5 class="pull-right">Total: 
        {{total}}
      </h5>
    </div>
  </div>
  <div class="row">
    <div class="col-xs-12">
      <div class="panel panel-default">
        <div class="panel-body">
          <div class="table-responsive">
            <table class="table table-condensed dataTable no-footer sales-table sales-table-with-checkbox">
              <thead>
                <tr>
                  <th>
                    <input type="checkbox">
                  </th>
                  <th ng-click="getSortedData('status')" ng-class="whatClassIsIt('status')">
                    Status 
                    <i class="fa fa-sort-down" ng-if="orderBy === 'status' && orderDir === 'asc'"></i>
                    <i class="fa fa-sort-up" ng-if="orderBy === 'status' && orderDir === 'desc'"></i>
                  </th>
                  <th ng-click="getSortedData('catType')" ng-class="whatClassIsIt('catType')">
                    Cat type
                    <i class="fa fa-sort-down" ng-if="orderBy === 'catType' && orderDir === 'asc'"></i>
                    <i class="fa fa-sort-up" ng-if="orderBy === 'catType' && orderDir === 'desc'"></i>
                  </th>
                  <th ng-click="getSortedData('distributionChannel')" ng-class="whatClassIsIt('distributionChannel')">
                    Dist Channel
                    <i class="fa fa-sort-down" ng-if="orderBy === 'distributionChannel' && orderDir === 'asc'"></i>
                    <i class="fa fa-sort-up" ng-if="orderBy === 'distributionChannel' && orderDir === 'desc'"></i>
                  </th>
                  <th ng-click="getSortedData('configuration')" ng-class="whatClassIsIt('configuration')">
                    Configuration
                    <i class="fa fa-sort-down" ng-if="orderBy === 'configuration' && orderDir === 'asc'"></i>
                    <i class="fa fa-sort-up" ng-if="orderBy === 'configuration' && orderDir === 'desc'"></i>
                  </th>
                  <th ng-click="getSortedData('priceCategory')" ng-class="whatClassIsIt('priceCategory')">
                    Price cat
                    <i class="fa fa-sort-down" ng-if="orderBy === 'priceCategory' && orderDir === 'asc'"></i>
                    <i class="fa fa-sort-up" ng-if="orderBy === 'priceCategory' && orderDir === 'desc'"></i>
                  </th>
                  <th ng-click="getSortedData('source')" ng-class="whatClassIsIt('source')">
                    Source
                    <i class="fa fa-sort-down" ng-if="orderBy === 'source' && orderDir === 'asc'"></i>
                    <i class="fa fa-sort-up" ng-if="orderBy === 'source' && orderDir === 'desc'"></i>
                  </th>
                  <th ng-click="getSortedData('subSource')" ng-class="whatClassIsIt('subSource')">
                    Subsource
                    <i class="fa fa-sort-down" ng-if="orderBy === 'subSource' && orderDir === 'asc'"></i>
                    <i class="fa fa-sort-up" ng-if="orderBy === 'subSource' && orderDir === 'desc'"></i>
                  </th>
                  <th ng-click="getSortedData('territory')" ng-class="whatClassIsIt('territory')">
                    Territory
                    <i class="fa fa-sort-down" ng-if="orderBy === 'territory' && orderDir === 'asc'"></i>
                    <i class="fa fa-sort-up" ng-if="orderBy === 'territory' && orderDir === 'desc'"></i>
                  </th>
                  <th ng-click="getSortedData('barcode')" ng-class="whatClassIsIt('barcode')">
                    Barcode
                    <i class="fa fa-sort-down" ng-if="orderBy === 'barcode' && orderDir === 'asc'"></i>
                    <i class="fa fa-sort-up" ng-if="orderBy === 'barcode' && orderDir === 'desc'"></i>
                  </th>
                  <th ng-click="getSortedData('catNo')" ng-class="whatClassIsIt('catNo')">
                    Cat no
                    <i class="fa fa-sort-down" ng-if="orderBy === 'catNo' && orderDir === 'asc'"></i>
                    <i class="fa fa-sort-up" ng-if="orderBy === 'catNo' && orderDir === 'desc'"></i>
                  </th>
                  <th ng-click="getSortedData('isrc')" ng-class="whatClassIsIt('isrc')">
                    ISRC
                    <i class="fa fa-sort-down" ng-if="orderBy === 'isrc' && orderDir === 'asc'"></i>
                    <i class="fa fa-sort-up" ng-if="orderBy === 'isrc' && orderDir === 'desc'"></i>
                  </th>
                  <th ng-click="getSortedData('identifier')" ng-class="whatClassIsIt('identifier')">
                    Identifier
                    <i class="fa fa-sort-down" ng-if="orderBy === 'identifier' && orderDir === 'asc'"></i>
                    <i class="fa fa-sort-up" ng-if="orderBy === 'identifier' && orderDir === 'desc'"></i>
                  </th>
                  <th ng-click="getSortedData('units')" ng-class="whatClassIsIt('units')">
                    Units
                    <i class="fa fa-sort-down" ng-if="orderBy === 'units' && orderDir === 'asc'"></i>
                    <i class="fa fa-sort-up" ng-if="orderBy === 'units' && orderDir === 'desc'"></i>
                  </th>
                  <th ng-click="getSortedData('originalCurrency')" ng-class="whatClassIsIt('originalCurrency')">
                    Original currency
                    <i class="fa fa-sort-down" ng-if="orderBy === 'originalCurrency' && orderDir === 'asc'"></i>
                    <i class="fa fa-sort-up" ng-if="orderBy === 'originalCurrency' && orderDir === 'desc'"></i>
                  </th>
                  <th ng-click="getSortedData('exchangeRate')" ng-class="whatClassIsIt('exchangeRate')">
                    Ex Rate
                    <i class="fa fa-sort-down" ng-if="orderBy === 'exchangeRate' && orderDir === 'asc'"></i>
                    <i class="fa fa-sort-up" ng-if="orderBy === 'exchangeRate' && orderDir === 'desc'"></i>
                  </th>
                  <th ng-click="getSortedData('salePrice')" ng-class="whatClassIsIt('salePrice')">
                    Sale price
                    <i class="fa fa-sort-down" ng-if="orderBy === 'salePrice' && orderDir === 'asc'"></i>
                    <i class="fa fa-sort-up" ng-if="orderBy === 'salePrice' && orderDir === 'desc'"></i>
                  </th>
                  <th ng-click="getSortedData('grossAmount')" ng-class="whatClassIsIt('grossAmount')">
                    Gross
                    <i class="fa fa-sort-down" ng-if="orderBy === 'grossAmount' && orderDir === 'asc'"></i>
                    <i class="fa fa-sort-up" ng-if="orderBy === 'grossAmount' && orderDir === 'desc'"></i>
                  </th>
                  <th ng-click="getSortedData('netAmount')" ng-class="whatClassIsIt('netAmount')">
                    Net
                    <i class="fa fa-sort-down" ng-if="orderBy === 'netAmount' && orderDir === 'asc'"></i>
                    <i class="fa fa-sort-up" ng-if="orderBy === 'netAmount' && orderDir === 'desc'"></i>
                  </th>
                  <th ng-click="getSortedData('originalReleaseTitle')" ng-class="whatClassIsIt('originalReleaseTitle')">
                    Release title
                    <i class="fa fa-sort-down" ng-if="orderBy === 'originalReleaseTitle' && orderDir === 'asc'"></i>
                    <i class="fa fa-sort-up" ng-if="orderBy === 'originalReleaseTitle' && orderDir === 'desc'"></i>
                  </th>
                  <th ng-click="getSortedData('originalReleaseArtist')" ng-class="whatClassIsIt('originalReleaseArtist')">
                    Release artist
                    <i class="fa fa-sort-down" ng-if="orderBy === 'originalReleaseArtist' && orderDir === 'asc'"></i>
                    <i class="fa fa-sort-up" ng-if="orderBy === 'originalReleaseArtist' && orderDir === 'desc'"></i>
                  </th>
                  <th ng-click="getSortedData('originalTrackArtist')" ng-class="whatClassIsIt('originalTrackArtist')">
                    Track artist
                    <i class="fa fa-sort-down" ng-if="orderBy === 'originalTrackArtist' && orderDir === 'asc'"></i>
                    <i class="fa fa-sort-up" ng-if="orderBy === 'originalTrackArtist' && orderDir === 'desc'"></i>
                  </th>
                  <th ng-click="getSortedData('originalTrackTitle')" ng-class="whatClassIsIt('originalTrackTitle')">
                    Track title
                    <i class="fa fa-sort-down" ng-if="orderBy === 'originalTrackTitle' && orderDir === 'asc'"></i>
                    <i class="fa fa-sort-up" ng-if="orderBy === 'originalTrackTitle' && orderDir === 'desc'"></i>
                  </th>
                  <th ng-click="getSortedData('saleDate')" ng-class="whatClassIsIt('saleDate')">
                    Sale date
                    <i class="fa fa-sort-down" ng-if="orderBy === 'saleDate' && orderDir === 'asc'"></i>
                    <i class="fa fa-sort-up" ng-if="orderBy === 'saleDate' && orderDir === 'desc'"></i>
                  </th>
                  <th ng-click="getSortedData('transactionDate')" ng-class="whatClassIsIt('transactionDate')">
                    Transaction date
                    <i class="fa fa-sort-down" ng-if="orderBy === 'transactionDate' && orderDir === 'asc'"></i>
                    <i class="fa fa-sort-up" ng-if="orderBy === 'transactionDate' && orderDir === 'desc'"></i>
                  </th>
                  <th ng-click="getSortedData('releaseId')" ng-class="whatClassIsIt('releaseId')">
                    Release id
                    <i class="fa fa-sort-down" ng-if="orderBy === 'releaseId' && orderDir === 'asc'"></i>
                    <i class="fa fa-sort-up" ng-if="orderBy === 'releaseId' && orderDir === 'desc'"></i>
                  </th>
                  <th ng-click="getSortedData('trackId')" ng-class="whatClassIsIt('trackId')">
                    Track id
                    <i class="fa fa-sort-down" ng-if="orderBy === 'trackId' && orderDir === 'asc'"></i>
                    <i class="fa fa-sort-up" ng-if="orderBy === 'trackId' && orderDir === 'desc'"></i>
                  </th>
                  <th ng-click="getSortedData('workId')" ng-class="whatClassIsIt('workId')">
                    Work id
                    <i class="fa fa-sort-down" ng-if="orderBy === 'workId' && orderDir === 'asc'"></i>
                    <i class="fa fa-sort-up" ng-if="orderBy === 'workId' && orderDir === 'desc'"></i>
                  </th>
                  <th></th>
                </tr>
              </thead>
              <tbody>
                <tr sales-unmapped-table-row ng-repeat="sale in sales" sale="sale" single="editSingle(sale)"></tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-xs-12 text-center">
      <pagination pages="pages" total="totalPages" current="currentPage" change-page="changePage(page)"></pagination>
    </div>
  </div>
</div>
<div class="modal fade stick-up" id="modalEditFields" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header clearfix text-left">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="pg-close fs-14"></i>
        </button>
        <h5>Update Fields</h5>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-sm-6">
            <div class="form-group">
              <label>Cat Type</label>
              <ui-select ng-model="sale.catType">
                <ui-select-match allow-clear="true">
                  <span ng-bind="$select.selected"></span>
                </ui-select-match>
                <ui-select-choices repeat="item in catTypes">
                  <span ng-bind="item"></span>
                </ui-select-choices>
              </ui-select>
            </div>
            <div class="form-group">
              <label>Distribution Channel</label>
              <ui-select ng-model="sale.distributionChannel">
                <ui-select-match allow-clear="true">
                  <span ng-bind="$select.selected"></span>
                </ui-select-match>
                <ui-select-choices repeat="item in distributionChannels">
                  <span ng-bind="item"></span>
                </ui-select-choices>
              </ui-select>
            </div>
            <div class="form-group">
              <label>Configuration</label>
              <ui-select ng-model="sale.configuration">
                <ui-select-match allow-clear="true">
                  <span ng-bind="$select.selected"></span>
                </ui-select-match>
                <ui-select-choices repeat="item in configurations">
                  <span ng-bind="item"></span>
                </ui-select-choices>
              </ui-select>
            </div>
            <div class="form-group">
              <label>Price Category</label>
              <ui-select ng-model="sale.priceCategory">
                <ui-select-match allow-clear="true">
                  <span ng-bind="$select.selected"></span>
                </ui-select-match>
                <ui-select-choices repeat="item in priceCategories">
                  <span ng-bind="item"></span>
                </ui-select-choices>
              </ui-select>
            </div>
            <div class="form-group">
              <label>Source</label>
              <input type="text" class="form-control" ng-model="sale.source">
            </div>
            <div class="form-group">
              <label>Sub Source</label>
              <input type="text" class="form-control" ng-model="sale.subSource">
            </div>
          </div>
          <div class="col-sm-6">
            <div class="form-group">
              <label>Currency</label>
              <ui-select ng-model="sale.currency">
                <ui-select-match allow-clear="true">
                  <span ng-bind="$select.selected.code"></span>
                </ui-select-match>
                <ui-select-choices repeat="currency.code as currency in currencies | orderBy: 'code'">
                  <span ng-bind-html="currency.code"></span>
                  <span> &nbsp; - &nbsp; </span>
                  <span ng-bind-html="currency.name"></span>
                </ui-select-choices>
              </ui-select>
            </div>
            <div class="form-group">
              <label>Exchange Rate</label>
              <input type="text" class="form-control" ng-model="sale.exchangeRate">
            </div>
            <div class="form-group">
              <label>Territory</label>
              <ui-select ng-model="sale.territory">
                <ui-select-match allow-clear="true">
                  <span ng-bind="$select.selected.name"></span>
                </ui-select-match>
                <ui-select-choices group-by="groupFind" repeat="territory.code as territory in territories">
                  <span class="country" ng-bind="territory.name"></span>
                </ui-select-choices>
              </ui-select>
            </div>
            <div class="form-group">
              <label>Sale Date</label>
              <div id="datepicker-component" class="form-group input-group date">
                <input type="text" class="form-control" ng-model="sale.saleDate" uib-datepicker-popup="dd/MM/yyyy" is-open="saleDatePopup" ng-click="openSaleDatePopup()">
                <span class="input-group-addon" ng-click="openSaleDatePopup()"><i class="fa fa-calendar"></i></span>
              </div>
            </div>
            <div class="form-group">
              <label>Transaction Date</label>
              <div id="datepicker-component" class="form-group input-group date">
                <input type="text" class="form-control" ng-model="sale.transactionDate" uib-datepicker-popup="dd/MM/yyyy" is-open="transactionDatePopup" ng-click="openTransactionDatePopup()">
                <span class="input-group-addon" ng-click="openTransactionDatePopup()"><i class="fa fa-calendar"></i></span>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-xs-12">
            <hr>
          </div>
          <div class="col-xs-6">
            <div class="form-group">
              <label>Release</label>
              <ui-select ng-model="sale.releaseId">
                <ui-select-match allow-clear="true">
                  <span ng-bind="$select.selected.title"></span>
                </ui-select-match>
                <ui-select-choices repeat="item._id as item in releases | filter:$select.search">
                  <span ng-bind="item.title"></span>
                </ui-select-choices>
              </ui-select>
            </div>
          </div>
          <div class="col-xs-6">
            <div class="form-group">
              <label>Track</label>
              <ui-select ng-model="sale.trackId">
                <ui-select-match allow-clear="true">
                  <span ng-bind="$select.selected.title"></span>
                </ui-select-match>
                <ui-select-choices repeat="item._id as item in tracks | filter:$select.search">
                  <span ng-bind="item.title"></span>
                </ui-select-choices>
              </ui-select>
            </div>
            <div class="form-group">
              <label>Work</label>
              <ui-select ng-model="sale.workId">
                <ui-select-match>
                  <span ng-bind="$select.selected.title"></span>
                </ui-select-match allow-clear="true">
                <ui-select-choices repeat="item._id as item in works | filter:$select.search">
                  <span ng-bind="item.title"></span>
                </ui-select-choices>
              </ui-select>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-xs-12 m-t-20 text-right">
            <button type="button" class="btn btn-default m-t-5" data-dismiss="modal">Cancel</button>
            <button type="button" ng-if="editType == 'single'" class="btn btn-complete m-t-5" ng-click="updateSingle(sale)"><i class="fa fa-check"></i>&nbsp;Update</button>
            <button type="button" ng-if="editType == 'selected'" class="btn btn-complete m-t-5" ng-click="updateSelected()"><i class="fa fa-check"></i>&nbsp;Update</button>
            <button type="button" ng-if="editType == 'filtered'" class="btn btn-complete m-t-5" ng-click="updateFiltered()"><i class="fa fa-check"></i>&nbsp;Update</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
